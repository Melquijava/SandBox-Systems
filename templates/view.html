<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>{{ project.name }} - Visualização</title>
    <style>
        body, html { 
            margin: 0; 
            padding: 0; 
            height: 100%; 
            overflow: hidden; 
        }
        iframe { 
            width: 100%; 
            height: 100%; 
            border: none; 
        }
    </style>
</head>
<body>
    <iframe id="view-frame"></iframe>

    <script>
        const projectData = {{ project|tojson|safe }};     
        const previewFrame = document.getElementById('view-frame');
        const sourceDocument = `
            <!DOCTYPE html>
            <html lang="pt-BR">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <style>${projectData.css || ''}</style>
            </head>
            <body>
                ${projectData.html || ''}
                
                <!-- Escapamos a barra da tag script para segurança -->
                <script>${projectData.js || ''}<\/script>
            </body>
            </html>
        `;
        previewFrame.srcdoc = sourceDocument;
    </script>
</body>
</html>